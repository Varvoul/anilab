---
layout: layouts/base.njk
pagination:
  data: posts
  size: 1
  alias: post
permalink: "/post/{{ post.id | slugify }}-{{ pagination.pageNumber }}/"
eleventyComputed:
  title: "{{ post.title }} - Quravel"
---
<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>{{ post.title }} - Quravel</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#498BBB",
                        "background-light": "#F3F4F6",
                        "background-dark": "#0B0E19",
                        "surface-dark": "#151926",
                        "footer-dark": "#0C0E14",
                        "text-light": "#E5E7EB",
                        "text-muted": "#9CA3AF"
                    },
                    fontFamily: {
                        display: ["Inter", "sans-serif"],
                        body: ["Inter", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "0.5rem",
                    },
                },
            },
        };
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
    <style>
    body {
        font-family: 'Inter', sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }
    
    .hide-scrollbar::-webkit-scrollbar {
        display: none;
    }
    
    .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
    
    #mobile-menu {
        transition: transform 0.3s ease-in-out;
        -webkit-transition: transform 0.3s ease-in-out;
    }
    
    .menu-open {
        transform: translateX(0) !important;
        -webkit-transform: translateX(0) !important;
    }
    
    /* Search suggestions styling */
    .search-suggestions {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        border-radius: 0.5rem;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        max-height: 400px;
        overflow-y: auto;
        z-index: 1000;
        margin-top: 5px;
    }
    
    .dark .search-suggestions {
        background: #151926;
        border: 1px solid #374151;
    }
    
    .search-item {
        display: flex;
        align-items: center;
        padding: 12px;
        border-bottom: 1px solid #e5e7eb;
        cursor: pointer;
        transition: background-color 0.2s;
        -webkit-transition: background-color 0.2s;
    }
    
    .dark .search-item {
        border-bottom: 1px solid #374151;
    }
    
    .search-item:hover {
        background-color: #f3f4f6;
    }
    
    .dark .search-item:hover {
        background-color: #1f2937;
    }
    
    .search-item:last-child {
        border-bottom: none;
    }
    
    .search-item img {
        width: 40px;
        height: 60px;
        object-fit: cover;
        border-radius: 4px;
        margin-right: 12px;
    }
    
    .search-item-content {
        flex: 1;
        min-width: 0;
    }
    
    .search-item-title {
        font-weight: 500;
        margin-bottom: 4px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    
    .search-item-meta {
        font-size: 12px;
        color: #6b7280;
    }
    
    .dark .search-item-meta {
        color: #9ca3af;
    }
    
    .no-results {
        padding: 20px;
        text-align: center;
        color: #6b7280;
    }
    
    .dark .no-results {
        color: #9ca3af;
    }
    
    /* Japanese font support */
    .font-japanese {
        font-family: "Hiragino Kaku Gothic Pro", "Meiryo", "MS PGothic", "ヒラギノ角ゴ Pro W3", "メイリオ", "ＭＳ Ｐゴシック", sans-serif;
        font-size: 14px;
        line-height: 1.6;
    }
    
    /* Season selector styling */
    .season-selector {
        transition: all 0.3s ease;
        -webkit-transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .season-selector:hover {
        transform: translateY(-2px);
        -webkit-transform: translateY(-2px);
    }
    
    .season-badge {
        position: absolute;
        top: 8px;
        right: 8px;
        background: linear-gradient(135deg, #498BBB, #3a6ea5);
        color: white;
        font-size: 10px;
        font-weight: bold;
        padding: 2px 6px;
        border-radius: 4px;
        z-index: 2;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .current-season {
        border: 2px solid #498BBB;
        box-shadow: 0 0 15px rgba(73, 139, 187, 0.3);
        position: relative;
    }
    
    .current-season::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border-radius: 0.5rem;
        box-shadow: inset 0 0 0 1px #498BBB;
        pointer-events: none;
    }
    
    .season-progress {
        height: 3px;
        background: rgba(73, 139, 187, 0.2);
        border-radius: 2px;
        overflow: hidden;
        margin-top: 4px;
    }
    
    .season-progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #498BBB, #5da8e8);
        transition: width 0.3s ease;
        -webkit-transition: width 0.3s ease;
        width: 0;
    }
    
    /* Fix for dark mode season cards */
    .dark .season-selector {
        background: #151926;
        border-color: #374151;
    }
    
    .dark .season-selector:hover {
        border-color: #498BBB;
    }
    
    /* Ensure images don't overflow season cards */
    .season-selector img {
        max-width: 100%;
        height: auto;
    }
    
    /* Dropdown styling */
    .dropdown-container .dropdown-menu {
        opacity: 0;
        visibility: hidden;
        transition: all 0.2s ease;
    }
    
    .dropdown-container:hover .dropdown-menu {
        opacity: 1;
        visibility: visible;
    }
</style>
</head>
<body class="bg-background-light dark:bg-background-dark text-gray-900 dark:text-text-light transition-colors duration-300 min-h-screen flex flex-col relative">

    <!-- Mobile Menu Overlay -->
    <div class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden" id="mobile-menu-overlay" onclick="toggleMobileMenu()"></div>
    
    <!-- Mobile Menu -->
    <div class="fixed top-0 left-0 h-full w-64 bg-white dark:bg-[#151926] z-50 transform -translate-x-full lg:hidden overflow-y-auto shadow-2xl" id="mobile-menu">
        <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
            <img alt="Quravel Logo" class="h-8 object-contain" src="https://cdn.imgchest.com/files/449aa5626e23.png"/>
            <button class="text-gray-500 hover:text-primary" onclick="toggleMobileMenu()">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        <div class="p-4 space-y-4">
            <a class="block text-sm font-medium hover:text-primary py-2 border-b border-gray-100 dark:border-gray-800" href="/">Home</a>
            <div class="py-2 border-b border-gray-100 dark:border-gray-800">
                <button class="flex items-center justify-between w-full text-sm font-medium hover:text-primary focus:outline-none" onclick="toggleMobileDropdown('genre-mobile')">
                    <span>Genre</span>
                    <span class="material-symbols-outlined text-sm transform transition-transform" id="genre-arrow">expand_more</span>
                </button>
                <div class="hidden mt-2 ml-4 space-y-2 text-sm text-gray-500 dark:text-gray-400" id="genre-mobile">
                    <a class="block hover:text-primary" href="#">Action</a>
                    <a class="block hover:text-primary" href="#">Adventure</a>
                    <a class="block hover:text-primary" href="#">Cars</a>
                    <a class="block hover:text-primary" href="#">Comedy</a>
                    <a class="block hover:text-primary" href="#">Dementia</a>
                    <a class="block hover:text-primary" href="#">Demons</a>
                    <a class="block hover:text-primary" href="#">Drama</a>
                    <a class="block hover:text-primary" href="#">Ecchi</a>
                    <a class="block hover:text-primary" href="#">Fantasy</a>
                    <a class="block hover:text-primary" href="#">Game</a>
                    <a class="block hover:text-primary" href="#">Harem</a>
                    <a class="block hover:text-primary" href="#">Historical</a>
                    <a class="block hover:text-primary" href="#">Horror</a>
                    <a class="block hover:text-primary" href="#">Isekai</a>
                    <a class="block hover:text-primary" href="#">Josei</a>
                    <a class="block hover:text-primary" href="#">Kids</a>
                    <a class="block hover:text-primary" href="#">Magic</a>
                    <a class="block hover:text-primary" href="#">Martial Arts</a>
                    <a class="block hover:text-primary" href="#">Mecha</a>
                    <a class="block hover:text-primary" href="#">Military</a>
                    <a class="block hover:text-primary" href="#">Music</a>
                    <a class="block hover:text-primary" href="#">Mystery</a>
                    <a class="block hover:text-primary" href="#">Noir</a>
                    <a class="block hover:text-primary" href="#">Parody</a>
                    <a class="block hover:text-primary" href="#">Police</a>
                    <a class="block hover:text-primary" href="#">Psychological</a>
                    <a class="block hover:text-primary" href="#">Politic</a>
                    <a class="block hover:text-primary" href="#">Romance</a>
                    <a class="block hover:text-primary" href="#">Reality-Show</a>
                    <a class="block hover:text-primary" href="#">Reality-TV</a>
                    <a class="block hover:text-primary" href="#">Samurai</a>
                    <a class="block hover:text-primary" href="#">School</a>
                    <a class="block hover:text-primary" href="#">Sci-Fi</a>
                    <a class="block hover:text-primary" href="#">Seinen</a>
                    <a class="block hover:text-primary" href="#">Shoujo</a>
                    <a class="block hover:text-primary" href="#">Shoujo Ai</a>
                    <a class="block hover:text-primary" href="#">Shounen</a>
                    <a class="block hover:text-primary" href="#">Shounen Ai</a>
                    <a class="block hover:text-primary" href="#">Slice of Life</a>
                    <a class="block hover:text-primary" href="#">Space</a>
                    <a class="block hover:text-primary" href="#">Sports</a>
                    <a class="block hover:text-primary" href="#">Super Power</a>
                    <a class="block hover:text-primary" href="#">Supernatural</a>
                    <a class="block hover:text-primary" href="#">Thriller</a>
                    <a class="block hover:text-primary" href="#">Vampire</a>
                    <a class="block hover:text-primary" href="#">War</a>
                </div>
            </div>
            <div class="py-2 border-b border-gray-100 dark:border-gray-800">
                <button class="flex items-center justify-between w-full text-sm font-medium hover:text-primary focus:outline-none" onclick="toggleMobileDropdown('country-mobile')">
                    <span>Country</span>
                    <span class="material-symbols-outlined text-sm transform transition-transform" id="country-arrow">expand_more</span>
                </button>
                <div class="hidden mt-2 ml-4 space-y-2 text-sm text-gray-500 dark:text-gray-400" id="country-mobile">
                    <a class="block hover:text-primary" href="#">Afghanistan</a>
                    <a class="block hover:text-primary" href="#">Algeria</a>
                    <a class="block hover:text-primary" href="#">Argentina</a>
                    <a class="block hover:text-primary" href="#">Australia</a>
                    <a class="block hover:text-primary" href="#">Austria</a>
                    <a class="block hover:text-primary" href="#">Bangladesh</a>
                    <a class="block hover:text-primary" href="#">Belgium</a>
                    <a class="block hover:text-primary" href="#">Brazil</a>
                    <a class="block hover:text-primary" href="#">Canada</a>
                    <a class="block hover:text-primary" href="#">Chile</a>
                    <a class="block hover:text-primary" href="#">China</a>
                    <a class="block hover:text-primary" href="#">Colombia</a>
                    <a class="block hover:text-primary" href="#">Czechia</a>
                    <a class="block hover:text-primary" href="#">Denmark</a>
                    <a class="block hover:text-primary" href="#">Egypt</a>
                    <a class="block hover:text-primary" href="#">Finland</a>
                    <a class="block hover:text-primary" href="#">France</a>
                    <a class="block hover:text-primary" href="#">Germany</a>
                    <a class="block hover:text-primary" href="#">Greece</a>
                    <a class="block hover:text-primary" href="#">Hong Kong</a>
                    <a class="block hover:text-primary" href="#">Hungary</a>
                    <a class="block hover:text-primary" href="#">Iceland</a>
                    <a class="block hover:text-primary" href="#">India</a>
                    <a class="block hover:text-primary" href="#">Indonesia</a>
                    <a class="block hover:text-primary" href="#">Iran</a>
                    <a class="block hover:text-primary" href="#">Ireland</a>
                    <a class="block hover:text-primary" href="#">Israel</a>
                    <a class="block hover:text-primary" href="#">Italy</a>
                    <a class="block hover:text-primary" href="#">Japan</a>
                    <a class="block hover:text-primary" href="#">Mexico</a>
                    <a class="block hover:text-primary" href="#">Netherlands</a>
                    <a class="block hover:text-primary" href="#">New Zealand</a>
                    <a class="block hover:text-primary" href="#">Nigeria</a>
                    <a class="block hover:text-primary" href="#">Pakistan</a>
                    <a class="block hover:text-primary" href="#">Philippines</a>
                    <a class="block hover:text-primary" href="#">Poland</a>
                    <a class="block hover:text-primary" href="#">Russia</a>
                    <a class="block hover:text-primary" href="#">South Africa</a>
                    <a class="block hover:text-primary" href="#">Spain</a>
                    <a class="block hover:text-primary" href="#">Sweden</a>
                    <a class="block hover:text-primary" href="#">Taiwan</a>
                    <a class="block hover:text-primary" href="#">Thailand</a>
                    <a class="block hover:text-primary" href="#">Turkey</a>
                    <a class="block hover:text-primary" href="#">UK</a>
                    <a class="block hover:text-primary" href="#">USA</a>
                </div>
            </div>
            <a class="block text-sm font-medium hover:text-primary py-2 border-b border-gray-100 dark:border-gray-800" href="#">Top IMDB</a>
            <a class="block text-sm font-medium hover:text-primary py-2 border-b border-gray-100 dark:border-gray-800" href="#">Updates</a>
            <a class="block text-sm font-medium hover:text-primary py-2" href="https://editor.wix.com/wixel-view/forms/7405900275916997729">Sent Request</a>
        </div>
    </div>

    <!-- Header -->
    <header class="fixed top-0 w-full z-40 bg-white/95 dark:bg-[#0B0E19]/95 backdrop-blur-sm border-b border-gray-200 dark:border-gray-800 shadow-sm">
        <div class="container mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <button class="lg:hidden text-gray-600 dark:text-gray-200 focus:outline-none" onclick="toggleMobileMenu()">
                    <span class="material-symbols-outlined text-3xl">menu</span>
                </button>
                <nav class="hidden lg:flex items-center space-x-6 text-sm font-medium">
                    <a class="hover:text-primary transition-colors" href="/">Home</a>
                    <div class="relative group">
                        <button class="flex items-center space-x-1 hover:text-primary transition-colors focus:outline-none py-4">
                            <span>Genre</span>
                            <span class="material-symbols-outlined text-sm">expand_more</span>
                        </button>
                        <div class="absolute top-full left-0 w-[600px] bg-white dark:bg-[#1A1D29] rounded-b-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 border-t-2 border-primary grid grid-cols-4 gap-4 p-6 z-50">
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Action</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Adventure</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Adult</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Cars</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Comedy</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Dementia</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Demons</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Drama</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Ecchi</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Fantasy</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Game</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Harem</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Historical</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Horror</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Isekai</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Josei</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Kids</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Magic</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Martial Arts</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Mecha</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Military</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Music</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Mystery</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Parody</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Police</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Politic</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Psychological</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Romance</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Samurai</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">School</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Sci-Fi</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Seinen</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Shoujo</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Shoujo Ai</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Shounen</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Shounen Ai</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Slice of Life</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Space</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Sports</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Super Power</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Supernatural</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Thriller</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Vampire</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">War</a>
                        </div>
                    </div>
                    <div class="relative group">
                        <button class="flex items-center space-x-1 hover:text-primary transition-colors focus:outline-none py-4">
                            <span>Country</span>
                            <span class="material-symbols-outlined text-sm">expand_more</span>
                        </button>
                        <div class="absolute top-full left-0 w-[600px] bg-white dark:bg-[#1A1D29] rounded-b-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 border-t-2 border-primary grid grid-cols-4 gap-4 p-6 z-50">
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Argentina</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Argentina</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Australia</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Austria</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Belgium</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Brazil</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Canada</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">China</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Colombia</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Czech Republic</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Denmark</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Finland</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">France</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Germany</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Hong Kong</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Hungary</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">India</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Ireland</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Israel</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Italy</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Japan</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Luxembourg</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Mexico</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Netherlands</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">New Zealand</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Nigeria</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Norway</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Philippines</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Poland</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Romania</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Russia</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">South Africa</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">South Korea</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Spain</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Sweden</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Switzerland</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Taiwan</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Thailand</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">Turkey</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">United Kingdom</a>
                            <a class="hover:text-primary block text-sm text-gray-600 dark:text-gray-400" href="#">United States</a>
                        </div>
                    </div>
                    <a class="hover:text-primary transition-colors" href="#">Top IMDB</a>
                    <a class="hover:text-primary transition-colors" href="#">Updates</a>
                    <a class="hover:text-primary transition-colors" href="https://editor.wix.com/wixel-view/forms/7405900275916997729">Sent Request</a>
                </nav>
            </div>
            
            <div class="absolute left-1/2 transform -translate-x-1/2">
                <a class="block" href="/">
                    <img alt="Quravel Logo" class="h-8 md:h-10 object-contain" src="https://lh3.googleusercontent.com/aida-public/AB6AXuBJUVSMqcvlsLRod5Xj-MZhjFAWxv45A-9D1r1RCogjetrU2yKas3rRIuvSZRytOe6KmnI1y8NBGlIDGaE0UV5-mx19YpDf5v0SsajVxTc0VUCDku8E8PC54rDIUGGhmt44NSDXMGfnGVTtfzGJ8Cj6U15erHms74L8zDNtfVtIjG013mT9k-H5Psf5KSd570YR8_DAtEfUBmcVIMfE5LNH3WO14T7Cv3psWjV5O4UWogAMASg1czrkMA4qcRagH2Mtb7wqzWRn0BQ"/>
                </a>
            </div>
            
            <div class="flex items-center space-x-4">
                <div class="relative hidden sm:block">
                    <div class="relative">
                        <input class="bg-gray-100 dark:bg-gray-800 text-sm rounded-full py-2 pl-4 pr-10 focus:outline-none focus:ring-2 focus:ring-primary w-48 transition-all dark:text-white border-none" placeholder="Search..." type="text" id="desktop-search"/>
                        <span class="material-symbols-outlined absolute right-3 top-2 text-gray-400 text-lg cursor-pointer hover:text-primary">search</span>
                        <div class="search-suggestions hidden" id="desktop-search-suggestions"></div>
                    </div>
                </div>
                <button class="sm:hidden text-gray-600 dark:text-gray-200" onclick="toggleMobileSearch()">
                    <span class="material-symbols-outlined">search</span>
                </button>
            </div>
        </div>
        
        <!-- Mobile Search Bar -->
        <div class="hidden sm:hidden bg-white dark:bg-[#0B0E19] border-b border-gray-200 dark:border-gray-800 p-3 absolute w-full top-16 left-0 z-30" id="mobile-search-bar">
            <div class="relative">
                <input class="w-full bg-gray-100 dark:bg-gray-800 text-sm rounded-full py-2 pl-4 pr-10 focus:outline-none focus:ring-2 focus:ring-primary dark:text-white border-none" placeholder="Search movies, shows..." type="text" id="mobile-search"/>
                <span class="material-symbols-outlined absolute right-3 top-2 text-gray-400 text-lg">search</span>
                <div class="search-suggestions hidden" id="mobile-search-suggestions"></div>
            </div>
        </div>
    </header>

    <main class="flex-grow pt-24 pb-12">
        <div class="container mx-auto px-4">
            <div class="bg-white dark:bg-[#151926] rounded-2xl p-6 md:p-8 lg:p-10 shadow-lg mb-12 relative overflow-hidden">
                <div class="absolute top-0 right-0 w-2/3 h-full bg-gradient-to-l from-primary/5 to-transparent pointer-events-none opacity-20"></div>
                <div class="flex flex-col md:flex-row gap-8 lg:gap-12 relative z-10">
                    <div class="flex-shrink-0 mx-auto md:mx-0 w-64 md:w-72 lg:w-80 relative group">
                        <img alt="Show Poster" class="w-full h-auto rounded-xl shadow-2xl object-cover aspect-[2/3] transform transition duration-500 hover:scale-[1.02]" src="{{ post.poster }}" onerror="this.src='https://via.placeholder.com/300x450?text=Poster+Not+Available'"/>
                        <div class="absolute inset-0 rounded-xl ring-1 ring-white/10 pointer-events-none"></div>
                    </div>
                    <div class="flex-grow flex flex-col justify-start text-center md:text-left">
                        <div class="text-primary text-sm font-semibold mb-2 uppercase tracking-wide">Home • {{ post.type | capitalize }} • {{ post.genres[0] if post.genres and post.genres.length > 0 else 'Action' }}</div>
                        <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4 leading-tight">{{ post.title }}</h1>
                        <div class="flex flex-wrap items-center justify-center md:justify-start gap-4 mb-6 text-sm">
                            <div class="flex items-center space-x-1 bg-yellow-500/10 text-yellow-500 px-2 py-1 rounded border border-yellow-500/20">
                                <span class="material-symbols-outlined text-base">star</span>
                                <span class="font-bold">{{ post.rating or 'N/A' }}</span>
                                <span class="text-xs opacity-70">IMDb</span>
                            </div>
                            <div class="px-2 py-0.5 rounded border border-primary text-primary bg-primary/10 text-xs font-mono font-bold">HD</div>
                            {% if post.certification %}
                            <span class="px-2 py-0.5 rounded border border-gray-300 dark:border-gray-600 text-xs">{{ post.certification }}</span>
                            {% endif %}
                            <span class="text-gray-500 dark:text-gray-400">• {{ post.type | capitalize }}</span>
                            <span class="text-gray-500 dark:text-gray-400">• {{ post.year }}</span>
                            <span class="text-gray-500 dark:text-gray-400">• {{ post.duration }}</span>
                        </div>
                        <div class="flex flex-wrap items-center justify-center md:justify-start gap-4 mb-8">
                            <a href="/watch/{{ post.title | slugify }}/" class="bg-primary hover:bg-opacity-90 text-white font-semibold py-3 px-8 rounded-full flex items-center gap-2 transition-all shadow-lg shadow-primary/30 transform hover:-translate-y-0.5 w-full md:w-auto justify-center">
                                <span class="material-symbols-outlined">play_arrow</span>
                                Watch now
                            </a>
                            <div class="relative group dropdown-container w-full md:w-auto">
                                <button class="bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-800 dark:text-white font-semibold py-3 px-6 rounded-full flex items-center justify-center gap-2 transition-colors w-full md:w-auto" id="add-to-list-btn">
                                    <span class="material-symbols-outlined">add</span>
                                    <span id="current-list-status">Add to list</span>
                                    <span class="material-symbols-outlined text-sm ml-1">expand_more</span>
                                </button>
                                <div class="dropdown-menu absolute left-0 top-full mt-2 w-full md:w-56 bg-white dark:bg-surface-dark rounded-lg shadow-xl py-2 z-20 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 border border-gray-200 dark:border-gray-700 text-sm">
                                    <button class="block w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300" onclick="updateListStatus('Planning to watch')">Planning to watch</button>
                                    <button class="block w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300" onclick="updateListStatus('Watching')">Watching</button>
                                    <button class="block w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300" onclick="updateListStatus('Completed')">Completed</button>
                                    <button class="block w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300" onclick="updateListStatus('Re-watching')">Re-watching</button>
                                    <button class="block w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300" onclick="updateListStatus('Dropped')">Dropped</button>
                                    <div class="border-t border-gray-200 dark:border-gray-700 my-1"></div>
                                    <button class="block w-full text-left px-4 py-2 hover:bg-red-50 dark:hover:bg-red-900/20 text-red-500" onclick="updateListStatus('Add to list')">Remove from list</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <p class="text-gray-600 dark:text-gray-300 leading-relaxed">
                                {{ post.description or "No description available." }}
                            </p>
                        </div>
                        
                        <!-- UPDATED: Wider Show Information Section -->
                        <div class="bg-white dark:bg-[#1A1D29] rounded-xl p-6 mb-8 shadow-lg border border-gray-200 dark:border-gray-800">
                            <h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white border-b border-gray-300 dark:border-gray-700 pb-2">Show Information</h3>
                            
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 text-sm">
                                <!-- Left Column -->
                                <div class="space-y-3">
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">English Title:</span>
                                        <span class="ml-4 text-gray-700 dark:text-gray-300">{{ post.title }}</span>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">Japanese:</span>
                                        <span class="ml-4 text-gray-700 dark:text-gray-300 font-japanese">
                                            {{ post.japaneseTitle or "暗殺者である俺のステータスが勇者よりも明らかに強いのだが" }}
                                        </span>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">Synonyms:</span>
                                        <span class="ml-4 text-gray-700 dark:text-gray-300">{{ post.synonyms or "Sutetsuyo" }}</span>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">Aired:</span>
                                        <span class="ml-4 text-gray-700 dark:text-gray-300">{{ post.aired or "Oct 7, 2025 to ?" }}</span>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">Premiered:</span>
                                        <span class="ml-4 text-gray-700 dark:text-gray-300">{{ post.premiered or "Fall 2025" }}</span>
                                    </div>
                                </div>
                                
                                <!-- Right Column -->
                                <div class="space-y-3">
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">Duration:</span>
                                        <span class="ml-4 text-gray-700 dark:text-gray-300">{{ post.duration or "24m" }}</span>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">Status:</span>
                                        <span class="ml-4">
                                            {% if post.status == "ongoing" or post.status == "airing" %}
                                            <span class="px-2 py-0.5 bg-green-500/10 text-green-500 text-xs font-medium rounded border border-green-500/20">
                                                Currently Airing
                                            </span>
                                            {% else %}
                                            <span class="px-2 py-0.5 bg-gray-500/10 text-gray-500 text-xs font-medium rounded border border-gray-500/20">
                                                {{ post.status or "Finished Airing" }}
                                            </span>
                                            {% endif %}
                                        </span>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">MAL Score:</span>
                                        <span class="ml-4 text-gray-700 dark:text-gray-300">{{ post.malScore or "?" }}</span>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">Genres:</span>
                                        <div class="ml-4 flex flex-wrap gap-2">
                                            {% if post.genres and post.genres.length > 0 %}
                                                {% for genre in post.genres %}
                                                <a href="#" class="text-xs px-2 py-1 bg-gray-100 dark:bg-gray-800 hover:bg-primary hover:text-white text-gray-700 dark:text-gray-300 rounded border border-gray-300 dark:border-gray-700 transition-colors">
                                                    {{ genre }}
                                                </a>
                                                {% endfor %}
                                            {% else %}
                                                <span class="text-xs px-2 py-1 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded border border-gray-300 dark:border-gray-700">Action</span>
                                                <span class="text-xs px-2 py-1 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded border border-gray-300 dark:border-gray-700">Adventure</span>
                                                <span class="text-xs px-2 py-1 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded border border-gray-300 dark:border-gray-700">Fantasy</span>
                                                <span class="text-xs px-2 py-1 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded border border-gray-300 dark:border-gray-700">Isekai</span>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">Studios:</span>
                                        <span class="ml-4 text-gray-700 dark:text-gray-300">{{ post.studio or "Sunrise" }}</span>
                                    </div>
                                    <div class="flex items-start">
                                        <span class="font-medium text-gray-900 dark:text-white min-w-32">Producers:</span>
                                        <span class="ml-4 text-gray-700 dark:text-gray-300">{{ post.producers or "TMS Entertainment, Kanon Sound" }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden">
                                <img alt="User Avatar" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCKepUuUHAz1GAAh9d1TP86fQ1cNEGF_A7Fi00ANN4rMbe5iAkgL18ZwXQ_bLabOJGS3Iw3kmWCMR-_bC6J8ZAQj7Fa0-ag_YKIFuGatJ4ZNgTMz3biJI_2j3tsHgv6s5Plmkoc0FaWk6FRXJ7WJDhwAwq6eIC8fEwWyZ8Qvnrk_GSsXRCVgO8Pvsa1YoJHTDbL3GoE4tSEYDIt8M5edImu39b2CQwvrurfgk06BuS_MZ3XIZgyYP78SnTXm3iVxTS6JSkhKhF0G4U"/>
                            </div>
                            <div class="text-xs">
                                <div class="font-bold text-primary">Share Quravel</div>
                                <div class="text-gray-500">to your friends</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Season Selector Section -->
            {% if post.seasons and post.seasons > 1 %}
            <div class="bg-white dark:bg-[#151926] rounded-xl p-6 mb-8 shadow-lg border border-gray-200 dark:border-gray-800">
                <h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white border-l-4 border-primary pl-4">All Seasons</h3>
                <p class="text-gray-600 dark:text-gray-300 mb-6 text-sm">This show has {{ post.seasons }} seasons. Select a season to watch:</p>
                
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                    {% for i in range(1, post.seasons + 1) %}
                        {% set seasonData = posts | getSeasonData(post.title | lower, i) %}
                        <a href="/post/{{ seasonData.slug or (post.title | slugify) }}-season-{{ i }}/" 
                           class="season-selector block bg-gray-50 dark:bg-surface-dark rounded-lg p-4 relative overflow-hidden border border-gray-200 dark:border-gray-700 hover:border-primary dark:hover:border-primary transition-all {% if i == (post.seasonNumber or 1) %}current-season{% endif %}">
                            
                            <!-- Season Badge -->
                            <div class="season-badge">
                                Season {{ i }}
                            </div>
                            
                            <!-- Season Info -->
                            <div class="text-center">
                                <div class="w-12 h-12 mx-auto mb-3 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-lg">
                                    {{ i }}
                                </div>
                                
                                <h4 class="font-semibold text-gray-900 dark:text-white text-sm mb-1 truncate">
                                    {% if seasonData.title %}
                                        {{ seasonData.title }}
                                    {% else %}
                                        {{ post.title }} - Season {{ i }}
                                    {% endif %}
                                </h4>
                                
                                <div class="text-xs text-gray-500 dark:text-gray-400 space-y-1">
                                    {% if seasonData.year %}
                                        <div class="flex items-center justify-center gap-1">
                                            <span class="material-symbols-outlined text-[10px]">calendar_month</span>
                                            {{ seasonData.year }}
                                        </div>
                                    {% endif %}
                                    
                                    {% if seasonData.episodes %}
                                        <div class="flex items-center justify-center gap-1">
                                            <span class="material-symbols-outlined text-[10px]">playlist_play</span>
                                            {{ seasonData.episodes }} episodes
                                        </div>
                                    {% endif %}
                                    
                                    {% if seasonData.rating %}
                                        <div class="flex items-center justify-center gap-1 text-yellow-500">
                                            <span class="material-symbols-outlined text-[10px]">star</span>
                                            {{ seasonData.rating }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <!-- Progress Bar -->
                                {% if i == (post.seasonNumber or 1) %}
                                    <div class="season-progress">
                                        <div class="season-progress-bar" style="width: {% if post.watchProgress %}{{ post.watchProgress }}{% else %}0{% endif %}%"></div>
                                    </div>
                                    <div class="text-[10px] text-gray-500 mt-1">Currently watching</div>
                                {% endif %}
                            </div>
                            
                            <!-- Highlight Current Season -->
                            {% if i == (post.seasonNumber or 1) %}
                                <div class="absolute inset-0 bg-primary/5 pointer-events-none"></div>
                            {% endif %}
                        </a>
                    {% endfor %}
                </div>
                
                <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
                        <div class="text-sm text-gray-600 dark:text-gray-300">
                            <span class="font-medium text-primary">Currently viewing:</span> Season {{ post.seasonNumber or 1 }}
                            {% if post.totalEpisodes %}
                            • {{ post.totalEpisodes }} total episodes
                            {% endif %}
                        </div>
                        
                        <div class="flex items-center gap-3">
                            {% if post.seasonNumber and post.seasonNumber > 1 %}
                                <a href="/post/{{ posts | getSeasonSlug(post.title | lower, post.seasonNumber - 1) or '#' }}" 
                                   class="text-sm text-primary hover:text-primary/80 font-medium flex items-center gap-1">
                                    <span class="material-symbols-outlined text-base">arrow_back</span>
                                    Previous Season
                                </a>
                            {% endif %}
                            
                            {% if post.seasonNumber and post.seasonNumber < post.seasons %}
                                <a href="/post/{{ posts | getSeasonSlug(post.title | lower, post.seasonNumber + 1) or '#' }}" 
                                   class="text-sm text-primary hover:text-primary/80 font-medium flex items-center gap-1">
                                    Next Season
                                    <span class="material-symbols-outlined text-base">arrow_forward</span>
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <div class="mb-12">
                <h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-white border-l-4 border-primary pl-4">You may like this</h2>
                <div class="relative group">
                    <div class="absolute inset-y-0 left-0 w-12 bg-gradient-to-r from-background-light dark:from-background-dark to-transparent z-10 pointer-events-none"></div>
                    <div class="absolute inset-y-0 right-0 w-12 bg-gradient-to-l from-background-light dark:from-background-dark to-transparent z-10 pointer-events-none"></div>
                    <button class="hidden lg:flex absolute left-0 top-1/2 -translate-y-1/2 z-20 bg-black/60 hover:bg-primary text-white p-2 rounded-full shadow-lg transform -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-all duration-300" onclick="scrollContainer('left')">
                        <span class="material-symbols-outlined text-2xl">chevron_left</span>
                    </button>
                    <button class="hidden lg:flex absolute right-0 top-1/2 -translate-y-1/2 z-20 bg-black/60 hover:bg-primary text-white p-2 rounded-full shadow-lg transform translate-x-1/2 opacity-0 group-hover:opacity-100 transition-all duration-300" onclick="scrollContainer('right')">
                        <span class="material-symbols-outlined text-2xl">chevron_right</span>
                    </button>
                    <div class="flex overflow-x-auto gap-4 pb-6 pt-2 px-2 hide-scrollbar snap-x snap-mandatory scroll-smooth" id="recommendations-container">
                        <!-- Recommendations will be dynamically loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-white dark:bg-footer-dark border-t border-gray-200 dark:border-gray-800 mt-auto">
        <div class="container mx-auto px-4 py-8 md:py-12">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
                <div class="flex-1 max-w-2xl">
                    <img alt="Quravel Logo" class="h-8 mb-4" src="https://cdn.imgchest.com/files/24d391d36c86.png"/>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-6 leading-relaxed">
                        Quravel is your destination for free, high-definition movies and TV series, all without ads. Stream instantly or download for offline viewing—perfect entertainment, wherever you go.
                    </p>
                    <p class="text-xs text-gray-500 dark:text-gray-500">
                        This site does not store any files on our server, we only linked to the media which is hosted on 3rd party services.
                        <br/>
                        Watch free Movies, watch free TV shows, watch free Anime online
                    </p>
                </div>
                <div class="flex flex-col items-center md:items-end gap-2 w-full md:w-auto">
                    <div class="flex gap-4 text-sm font-semibold text-gray-700 dark:text-gray-300">
                        <a class="hover:text-primary transition-colors" href="https://editor.wix.com/wixel-view/forms/7405900275916997729">REQUEST</a>
                        <a class="hover:text-primary transition-colors" href="https://editor.wix.com/wixel-view/forms/7405879446906864641">CONTACT</a>
                    </div>
                    <div class="text-xs text-gray-500 dark:text-gray-500 mt-2 text-center md:text-right w-full">
                        <span class="text-primary font-bold">Quravel</span>
                        <br/>
                        @ 2025 Quravel
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
    // FIXED: Simplified fallback - posts is now always array
    const postsArray = {% if posts %}{{ posts | json | safe }}{% else %}[]{% endif %};

    searchData = postsArray.map(post => ({
        id: post.id || post.title?.replace(/\s+/g, '-').toLowerCase() || 'no-id',
        title: post.title || 'Untitled',
        type: post.type || 'movie',
        year: post.year || 'N/A',
        rating: post.rating || 'N/A',
        duration: post.duration || 'N/A',
        genres: post.genres || [],
        poster: post.poster || 'https://via.placeholder.com/48x64?text=No+Image',
        slug: post.slug || post.title.toLowerCase().replace(/\s+/g, '-').replace(/[^\w-]+/g, '')
    }));

    // Global variable to store posts data
    let postsData = [];

    // Initialize posts data from 11ty
    function initializePostsData() {
        // Use postsArray from 11ty template
        postsData = searchData || [];
        
        console.log("Posts data initialized:", postsData.length, "posts");
        
        // Populate recommendations
        populateRecommendations();
        
        // Initialize search functionality
        initializeSearch();
    }

    // Populate "You may like this" section with SMART algorithm
    function populateRecommendations() {
        const container = document.getElementById('recommendations-container');
        if (!container || postsData.length === 0) {
            container.innerHTML = '<div class="text-gray-500 dark:text-gray-400 p-4">No recommendations available</div>';
            return;
        }

        // Clear existing content
        container.innerHTML = '';

        // Get current post details
        const currentPostTitle = "{{ post.title }}".toLowerCase();
        const currentPostGenres = {{ post.genres | json | safe if post.genres else '[]' }};
        const currentPostType = "{{ post.type }}";
        
        // Filter out current post
        const otherPosts = postsData.filter(post => {
            const postTitle = post.title.toLowerCase();
            return postTitle !== currentPostTitle;
        });

        // Score each post based on criteria
        const scoredPosts = otherPosts.map(post => {
            let score = 0;
            
            // 1. GENRE MATCH (Highest Priority: 50 points per match)
            if (currentPostGenres && currentPostGenres.length > 0 && post.genres && post.genres.length > 0) {
                const matchingGenres = currentPostGenres.filter(genre => 
                    post.genres.includes(genre)
                );
                score += matchingGenres.length * 50;
            }
            
            // 2. TYPE MATCH (High Priority: 30 points)
            if (post.type === currentPostType) {
                score += 30;
            }
            
            // 3. HIGH RATING (Medium Priority: points based on rating)
            if (post.rating && post.rating !== 'N/A') {
                const ratingNum = parseFloat(post.rating);
                if (!isNaN(ratingNum)) {
                    if (ratingNum >= 9.0) score += 40;
                    else if (ratingNum >= 8.5) score += 30;
                    else if (ratingNum >= 8.0) score += 20;
                    else if (ratingNum >= 7.5) score += 10;
                }
            }
            
            // 4. RECENT YEAR (Low Priority: 5 points if within 5 years)
            const currentYear = parseInt("{{ post.year }}") || 0;
            const postYear = parseInt(post.year) || 0;
            if (!isNaN(currentYear) && !isNaN(postYear)) {
                const yearDiff = Math.abs(currentYear - postYear);
                if (yearDiff <= 5) {
                    score += 5;
                }
            }
            
            return {
                ...post,
                score: score
            };
        });

        // Sort by score (highest first)
        const sortedPosts = scoredPosts.sort((a, b) => b.score - a.score);
        
        // Select top 8 posts
        const topRecommendations = sortedPosts.slice(0, 8);
        
        // Display recommendations
        topRecommendations.forEach(post => {
            const postElement = document.createElement('a');
            postElement.className = 'flex-shrink-0 w-40 sm:w-48 group snap-start';
            
            // Create slug for URL - FIXED: Using correct pattern
            const postSlug = post.slug || post.title.toLowerCase().replace(/[^\w]+/g, '-');
            postElement.href = `/post/${postSlug}/`;
            
            // Calculate matching genres
            let matchingGenres = [];
            if (currentPostGenres && post.genres) {
                matchingGenres = currentPostGenres.filter(genre => 
                    post.genres.includes(genre)
                );
            }
            
            postElement.innerHTML = `
                <div class="relative aspect-[2/3] rounded-lg overflow-hidden mb-3 bg-gray-200 dark:bg-gray-800 shadow-md transition-transform duration-300 group-hover:scale-105 group-hover:shadow-primary/20">
                    <img alt="${post.title}" class="w-full h-full object-cover" src="${post.poster}" loading="lazy" onerror="this.src='https://via.placeholder.com/300x450?text=Poster+Not+Available'">
                    <div class="absolute top-2 right-2 bg-primary text-white text-[10px] font-bold px-1.5 py-0.5 rounded">HD</div>
                    <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                        <div class="bg-white/20 backdrop-blur rounded-full p-3 text-white">
                            <span class="material-symbols-outlined text-2xl">play_arrow</span>
                        </div>
                    </div>
                </div>
                <h3 class="font-medium text-sm text-gray-900 dark:text-white truncate group-hover:text-primary transition-colors">
                    ${post.title}
                    ${matchingGenres.length > 0 ? 
                        `<span class="inline-block ml-1 text-[10px] text-primary" title="Matching genres: ${matchingGenres.join(', ')}">✓</span>` : 
                        ''}
                </h3>
                <div class="flex items-center text-xs text-gray-500 dark:text-gray-400 mt-1 gap-2">
                    <span>${post.year || ''}</span>
                    <span class="w-1 h-1 bg-gray-500 rounded-full"></span>
                    <span>${post.type === 'anime' ? 'Anime' : post.type === 'tv' ? 'TV Show' : 'Movie'}</span>
                    <span class="w-1 h-1 bg-gray-500 rounded-full"></span>
                    <span class="flex items-center gap-0.5">
                        <span class="material-symbols-outlined text-[10px]">star</span>
                        ${post.rating || 'N/A'}
                    </span>
                </div>
                <div class="mt-1 flex flex-wrap gap-1">
                    ${post.genres ? post.genres.slice(0, 2).map(genre => 
                        `<span class="text-[9px] px-1 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 rounded">${genre}</span>`
                    ).join('') : ''}
                </div>
            `;
            
            container.appendChild(postElement);
        });

        // If no recommendations found
        if (topRecommendations.length === 0) {
            container.innerHTML = `
                <div class="col-span-full text-center py-8 text-gray-500 dark:text-gray-400">
                    <span class="material-symbols-outlined text-4xl mb-2 opacity-50">search_off</span>
                    <p>No similar recommendations found</p>
                </div>
            `;
        }
    }

    // Search functionality
    function initializeSearch() {
        const desktopSearch = document.getElementById('desktop-search');
        const mobileSearch = document.getElementById('mobile-search');
        const desktopSuggestions = document.getElementById('desktop-search-suggestions');
        const mobileSuggestions = document.getElementById('mobile-search-suggestions');

        if (desktopSearch && desktopSuggestions) {
            desktopSearch.addEventListener('input', (e) => {
                showSearchSuggestions(e.target.value, desktopSuggestions);
            });
            
            desktopSearch.addEventListener('focus', () => {
                if (desktopSearch.value.trim()) {
                    showSearchSuggestions(desktopSearch.value, desktopSuggestions);
                }
            });
        }

        if (mobileSearch && mobileSuggestions) {
            mobileSearch.addEventListener('input', (e) => {
                showSearchSuggestions(e.target.value, mobileSuggestions);
            });
            
            mobileSearch.addEventListener('focus', () => {
                if (mobileSearch.value.trim()) {
                    showSearchSuggestions(mobileSearch.value, mobileSuggestions);
                }
            });
        }

        // Hide suggestions when clicking outside
        document.addEventListener('click', (e) => {
            const isDesktopSearch = desktopSearch && desktopSearch.contains(e.target);
            const isDesktopSuggestions = desktopSuggestions && desktopSuggestions.contains(e.target);
            const isMobileSearch = mobileSearch && mobileSearch.contains(e.target);
            const isMobileSuggestions = mobileSuggestions && mobileSuggestions.contains(e.target);
            
            if (!isDesktopSearch && !isDesktopSuggestions && desktopSuggestions) {
                desktopSuggestions.classList.add('hidden');
            }
            
            if (!isMobileSearch && !isMobileSuggestions && mobileSuggestions) {
                mobileSuggestions.classList.add('hidden');
            }
        });
    }

    function showSearchSuggestions(query, suggestionsContainer) {
        if (!query.trim() || !suggestionsContainer) {
            if (suggestionsContainer) {
                suggestionsContainer.classList.add('hidden');
            }
            return;
        }

        const searchTerm = query.toLowerCase();
        const filteredPosts = postsData.filter(post => 
            post.title.toLowerCase().includes(searchTerm) ||
            (post.genres && post.genres.some(genre => genre.toLowerCase().includes(searchTerm))) ||
            (post.type && post.type.toLowerCase().includes(searchTerm))
        );

        if (filteredPosts.length === 0) {
            suggestionsContainer.innerHTML = '<div class="no-results">No results found</div>';
        } else {
            suggestionsContainer.innerHTML = filteredPosts.slice(0, 5).map(post => {
                // FIXED: Use slug from post data or generate from title
                const postSlug = post.slug || post.title.toLowerCase().replace(/[^\w]+/g, '-');
                return `
                    <a href="/post/${postSlug}/" class="search-item">
                        <img src="${post.poster}" alt="${post.title}" onerror="this.src='https://via.placeholder.com/40x60?text=Poster'">
                        <div class="search-item-content">
                            <div class="search-item-title">${post.title}</div>
                            <div class="search-item-meta">
                                ${post.year || ''} • ${post.type === 'anime' ? 'Anime' : post.type === 'tv' ? 'TV Show' : 'Movie'} • ${post.rating ? `⭐ ${post.rating}` : ''}
                            </div>
                        </div>
                    </a>
                `;
            }).join('');
        }
        
        suggestionsContainer.classList.remove('hidden');
    }

    // Local Storage logic for "Add to list" button
    const listButtonText = document.getElementById('current-list-status');
    const storageKey = 'quravel_list_{{ post.title | slugify }}';
    
    // Initialize button text from local storage
    const savedStatus = localStorage.getItem(storageKey);
    if (savedStatus) {
        if(savedStatus === 'Add to list') {
            listButtonText.innerText = 'Add to list';
        } else {
            listButtonText.innerText = savedStatus;
        }
    }
    
    function updateListStatus(status) {
        if (status === 'Add to list') {
            listButtonText.innerText = 'Add to list';
            localStorage.removeItem(storageKey);
        } else {
            listButtonText.innerText = status;
            localStorage.setItem(storageKey, status);
        }
    }
    
    // Mobile Menu Toggle
    function toggleMobileMenu() {
        const menu = document.getElementById('mobile-menu');
        const overlay = document.getElementById('mobile-menu-overlay');
        menu.classList.toggle('menu-open');
        overlay.classList.toggle('hidden');
    }
    
    // Mobile Search Toggle
    function toggleMobileSearch() {
        const searchBar = document.getElementById('mobile-search-bar');
        searchBar.classList.toggle('hidden');
    }
    
    // Mobile Dropdown Accordion
    function toggleMobileDropdown(id) {
        const dropdown = document.getElementById(id);
        dropdown.classList.toggle('hidden');
        const arrowId = id === 'genre-mobile' ? 'genre-arrow' : 'country-arrow';
        const arrow = document.getElementById(arrowId);
        if (dropdown.classList.contains('hidden')) {
            arrow.style.transform = 'rotate(0deg)';
        } else {
            arrow.style.transform = 'rotate(180deg)';
        }
    }
    
    // Scroll Logic for "You may like this"
    function scrollContainer(direction) {
        const container = document.getElementById('recommendations-container');
        const scrollAmount = 300;
        if (direction === 'left') {
            container.scrollLeft -= scrollAmount;
        } else {
            container.scrollLeft += scrollAmount;
        }
    }

    // Initialize everything when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        initializePostsData();
    });
</script>
</body>
</html>